"use strict";function DVue(n,t){var n=n||Vue;return function(i){return n.extend(Object.keys(i).reduceRight(function(t,r){return n.hasOwnProperty(r)||(t[r]=i[r]),t},t||{name:i.name}))}}var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},Action,__decorate,VAYU;typeof CustomEvent!="function"&&function(){function n(n,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}n.prototype=Event.prototype;window.CustomEvent=n}();Action=function(){function n(t,i,r){var f=this,u;this._inertia=!0;this._ev={};this._cache={};this._queue=[];this._cb=i||function(n){t.dispatchEvent(new window.CustomEvent("action",{detail:n}))};r=r||{};for(u in n._defaults)r[u]=u in r?r[u]:n._defaults[u];this._inertia=r.inertia;(r.onmouse&&n.SPRT_MOUSE||r.onmouse===1)&&new n.Input.Mouse(t,this._callback.bind(this));(r.onwheel&&n.SPRT_MOUSE||r.onwheel===1)&&n.Input.addListeners(t,"mousewheel DOMMouseScroll",function(n){var t={s:Math.pow(1.2,Math.max(-1,Math.min(1,n.wheelDelta||-n.detail))),isMulti:!1};t.isFirst=t.isLast=t.isWheel=!0;t.x=t.y=t.r=0;t.pageX=n.pageX;t.pageY=n.pageY;t.clientX=n.clientX;t.clientY=n.clientY;f._cb(t)});(r.ontouch&&n.SPRT_TOUCH||r.ontouch===1)&&new n.Input.Touch(t,this._callback.bind(this));(r.onpoint&&n.SPRT_POINT||r.onpoint===1)&&new n.Input.Point(t,this._callback.bind(this))}return n.prototype._callback=function(t,i){var r=this._cache,u={x:0,y:0,r:0,s:1,pageX:null,pageY:null,clientX:null,clientY:null,isFirst:t===n.EVTYPE.START,isLast:t===n.EVTYPE.END,isMulti:i.length>1,points:i,timestamp:Date.now()},c,l,a,v,f,o,h,y,e,s;if(i.length&&(r.pX=i[0].pageX,r.pY=i[0].pageY,r.cX=i[0].clientX,r.cY=i[0].clientY,u.isMulti&&(c=r.pX-i[1].clientX,l=r.pY-i[1].clientY,r.pX=(r.pX+i[1].pageX)/2,r.pY=(r.pY+i[1].pageY)/2,r.cX=(r.cX+i[1].clientX)/2,r.cY=(r.cY+i[1].clientY)/2,a=Math.sqrt(Math.pow(Math.abs(c),2)+Math.pow(Math.abs(l),2)),v=-Math.atan2(c,l))),u.pageX=r.pX,u.pageY=r.pY,u.clientX=r.cX,u.clientY=r.cY,u.isFirst||u.isLast||(u.x=r.cX-r.x,u.y=r.cY-r.y,u.s=a/r.d||1,u.r=v-r.r||0),r.x=r.cX,r.y=r.cY,r.d=a,r.r=v,this._cb(u),this._inertia)if(f=this._queue,o=this._inertiaFn,u.isLast){if(h=performance.now(),f.length<3||o.active&&h-o.active<20||i.length&&this._inertia<0)return;for(y=Date.now(),e=f.length-1;e>1;e--)s=Math.max(y-f[e].timestamp,1),r.vx=(r.vx+f[e].x/s)/2,r.vy=(r.vy+f[e].y/s)/2,f[e].isMulti&&(r.vs=(r.vs+(f[e].s-1)/s)/2,r.vr=(r.vr+f[e].r/s)/2);r.vs=Math.max(-.001,Math.min(.001,r.vs));r.vr=Math.max(-.003,Math.min(.003,r.vr));f.length=0;o.active||(o.active=h,u.isLast=!(u.isFirst=u.isInertia=!0),u.isMulti=!!i.length,delete u.points,delete u.timestamp,this._ev=u,this._inertiaFn(0,h),u.isFirst=!1)}else u.isFirst&&(o.active=f.length=r.vx=r.vy=r.vs=r.vr=0),f.unshift(u)>6&&(f.length=6)},n.prototype._inertiaFn=function(n,t){var f=this,r=this._ev,i=this._cache,u=this._inertiaFn;u.active&&Math.abs(i.vx)>.015||Math.abs(i.vy)>.015||Math.abs(i.vr)>.0003||Math.abs(i.vs)>.0001?(r.x=n*i.vx,r.y=n*i.vy,r.r=n*i.vr,r.s=n*i.vs+1,i.vx*=.94,i.vy*=.94,i.vr*=.9,i.vs*=.9,requestAnimationFrame(function(n){return f._inertiaFn(n-t,n)})):(r.isLast=!!u.active,u.active=r.x=r.y=r.r=0,r.s=1);this._cb(r)},n.SPRT_MOUSE=!/mobile|ip(ad|hone|od)|android/i.test(navigator.userAgent),n.SPRT_TOUCH="ontouchstart"in window,n.SPRT_POINT="MSPointerEvent"in window,n._defaults={onmouse:!0,onwheel:!0,ontouch:!0,onpoint:!0,inertia:!0},n}(),function(n){var t,i;(function(n){n[n.START=1]="START";n[n.MOVE=2]="MOVE";n[n.END=4]="END";n[n.CANCEL=8]="CANCEL"})(n.EVTYPE||(n.EVTYPE={}));t=n.EVTYPE;i=function(){function n(t,i,r){var f=this,u;this.$=[];this._cb=i;this.listener=function(n){f.handler(n)};u=t.ownerDocument.defaultView||t.ownerDocument.parentWindow;n.addListeners(t,r.evTGT,this.listener,!1);n.addListeners(u,r.evWIN,this.listener,!1)}return n.addListeners=function(n,t,i,r){t.split(" ").forEach(function(t){n.addEventListener(t,i,r)})},n.removeListeners=function(n,t,i,r){t.split(" ").forEach(function(t){n.removeEventLister(t,i,r)})},n.prototype.handler=function(){},n.prototype.setPoint=function(n,t){t?this.$.splice(n,1,{pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY}):this.$.splice(n,1)},n}();n.Input=i,function(n){var u=function(n){function i(t,r){n.call(this,t,r,i);this.offset=80}return __extends(i,n),i.prototype.handler=function(n,r){var u;if(r=r||i.evMAP[n.type],u=this.$,u.length||r===t.START)if(r&t.MOVE)if(u.length&&u.length===(n.shiftKey?2:this._which)){if(u.length===1)this.setPoint(0,n);else{var s=this.offset,f=this._ev,e=f.clientX-n.clientX+s,o=f.clientY-n.clientY-s;e||o||(e=o=1);u.splice(0,1,{pageX:f.pageX+e,pageY:f.pageY+o,clientX:f.clientX+e,clientY:f.clientY+o});u.splice(1,1,{pageX:f.pageX-e,pageY:f.pageY-o,clientX:f.clientX-e,clientY:f.clientY-o})}this._cb(r&t.START?t.START:t.MOVE,u)}else u.length&&(1===(u.length=n.shiftKey?2:this._which)?(this.setPoint(0,n),this.setPoint(1,null),this._cb(t.END,u)):(this._ev=n,this.handler(n,r+t.START)));else r===t.END?(u.length=0,this._cb(r,u)):r===t.START&&(this._which=n.which,1===(u.length=this._which<3?n.shiftKey?2:this._which:0)?this.setPoint(1,null):this._ev=n,this.handler(n,r+t.MOVE))},i.evMAP={mousedown:t.START,mousemove:t.MOVE,mouseup:t.END},i.evTGT="mousedown",i.evWIN="mousemove mouseup",i}(n),i,r;n.Mouse=u;i=function(n){function i(t,r){n.call(this,t,r,i)}return __extends(i,n),i.prototype.handler=function(n,t){n.preventDefault();t=t||i.evMAP[n.type];var r=this.$;(r.length=Math.min(n.touches.length,2))&&(this.setPoint(0,n.touches[0]),this.setPoint(1,n.touches[1]));this._cb(t,r)},i.evMAP={touchstart:t.START,touchmove:t.MOVE,touchend:t.END,touchcancel:t.CANCEL},i.evTGT="touchstart",i.evWIN="touchmove touchend touchcancel",i}(n);n.Touch=i;r=function(n){function i(t,r){n.call(this,t,r,i);this._pid=[]}return __extends(i,n),i.prototype.handler=function(n,r){if(n.pointerType!=="mouse"){n.preventDefault();r=r||i.evMAP[n.type];var e=this.$,f=this._pid,u=f.indexOf(n.pointerId);r&t.MOVE?u>-1&&(this.setPoint(u,n),this._cb(r&t.START?t.START:t.MOVE,e)):r===t.END?u>-1&&(this.setPoint(u,null),f.splice(u,1),this._cb(r,e)):r===t.START&&f.length<2&&(this.setPoint(1,f.push(n.pointerId)===1?null:n),this.handler(n,r+t.MOVE))}},i.evMAP={pointerdown:t.START,pointermove:t.MOVE,pointerup:t.END,pointercancel:t.CANCEL,pointerout:t.CANCEL,MSPointerDown:t.START,MSPointerMove:t.MOVE,MSPointerUp:t.END,MSPointerCancel:t.CANCEL},i.evTGT=window.navigator.msPointerEnabled?"MSPointerDown":"pointerdown",i.evWIN=window.navigator.msPointerEnabled?"MSPointerMove MSPointerUp MSPointerCancel":"pointermove pointerup pointercancel",i}(n);n.Point=r}(i=n.Input||(n.Input={}))}(Action||(Action={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};__decorate=this&&this.__decorate||function(n,t,i,r){if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")return Reflect.decorate(n,t,i,r);switch(arguments.length){case 2:return n.reduceRight(function(n,t){return t&&t(n)||n},t);case 3:return n.reduceRight(function(n,r){return r&&r(t,i),void 0},void 0);case 4:return n.reduceRight(function(n,r){return r&&r(t,i,n)||n},r)}};Math.R2D=180/Math.PI;Math.D2R=Math.PI/180;Math.PIx2=Math.PI*2;Math.PI_2=Math.PI/2;VAYU=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.stopEvent=function(n){return n.stopPropagation(),n},t.prototype.update=function(){this.view.update=!(this.view.update=!1)},t.prototype._onResize=function(){var n=this.view,t=this.$el.getBoundingClientRect();(n.cx=(n.w=t.width)/2,n.cy=(n.h=t.height)/2,isNaN(n.cntrC[0]+n.cntrC[1]))||(n.cntrL=n.g2l([n.cx,n.cy]),this.center=n.cntrC)},t.temp=function(n){return(document.currentScript||document.body).ownerDocument.getElementById("vayu_"+n)},t.template=t.temp("VAYU"),t.replace=!0,t.data=function(){return{class_action:!1,class_inertia:!1,view:new t.View,layers:[]}},t.methods={stopEvent:t.prototype.stopEvent,update:t.prototype.update,_onResize:t.prototype._onResize},t.filters={rctx:function(n){var e,o,r,i,f,u;if(!n.length)return[];for(e=[],o=window.VAYU.options.components,i=0;i<n.length;i++){if(f=n[i].rctx||t.RCTX.TYPE[o["vayu-"+n[i].type].options.rctx],!f)return;u=n[i]._uid;u||Object.defineProperty(n[i],"_uid",{value:u=this.$root._uid++});r&&r._rctx==f?(r.layers.push(n[i]),r._uid+="_"+u):e.push(r={layers:[n[i]],_rctx:f,_uid:u})}return e}},t.computed={center:{get:function(){return this.view.cntrC},set:function(n){var t=this.view;n=t.c2l(n,t.dim);t.transform(t.projX(t.cntrL,t.m)-t.projX(n,t.m),t.projY(t.cntrL,t.m)-t.projY(n,t.m))}},zoom:{get:function(){return this.view.z},set:function(n){var t=this.view;t.transform(0,0,Math.pow(2,n-t.z))}},rotation:{get:function(){return this.view.r*Math.R2D},set:function(n){var t=this.view;t.transform(0,0,1,n*Math.D2R-t.r)}}},t.created=function(){t.unveil(this,"created");var n=this;n._uid=0},t.ready=function(){var u=this,i,n;t.unveil(this,"ready");i=this;n=i.view;this.layers=this.$options.layers;(i.reqQueue=[]).max=9;Vue.util.on(window,"resize",i._onResize);i._onResize();this.$watch("layers",this.$root.update,{deep:!0});var s=new Action(i.$el,function(n){i.view.transform(n.x,n.y,n.s,n.r,n.clientX,n.clientY);(n.isFirst||n.isLast)&&(u.class_action=n.isFirst&&!n.isWheel,u.class_inertia=n.isFirst&&n.isInertia)}),r=i.$options,f=n.c2l(r.center||[0,0]),e=Math.pow(2,r.zoom||0),o=(r.rotation||0)*Math.D2R;n.transform(n.cx-n.projX(f,n.m),n.cy-n.projY(f,n.m),e,o)},t=__decorate([DVue()],t)}(Vue),function(n){var t,i;n.version="0.3.0";console.log("%c VAYU ["+n.version+"] ","color:#42b983;background-color:#333;font-weight:bold;font-size:20px;");n.config={debug:!0,verbose:!0};n.log=function(){for(var i=[],t=0;t<arguments.length;t++)i[+t]=arguments[t];n.config.debug&&console.log.apply(console,i)};n.unveil=function(t,i,r){n.config.verbose&&console.log("["+((r||"")+t.constructor.name)+(t.id?" '"+t.id+"' ":" ")+i+"]",t)};t=function(){function n(n,t){n===void 0&&(n=new i.EPSG3857);t===void 0&&(t=256);this.m=new Float64Array([1,0,0,0,1]);this.ṁ=new Float64Array(4);this.m_=new Float64Array(5);this.ṁ_=new Float64Array(4);this.s=1;this.z=0;this.r=0;this.w=0;this.h=0;this.cx=0;this.cy=0;this.cntrL=[NaN,NaN];this.cntrG=[NaN,NaN];this.cntrC=[NaN,NaN];this.tranMX=null;this.tranUX=null;this.tranUS=null;this.tranUR=null;this.restrictZ=[0,18];this.restrictCntr=!0;this.update=!0;this.crs=n;this.dim=t;this.dimc=t/2}return n.prototype.transform=function(n,t,i,r,u,f,e){var s=this,h=s.m,y=s.ṁ,o=s.m_,c=s.ṁ_,k=i&&(i!==1||r),p,v;if(o[0]=h[0],o[1]=h[1],o[2]=h[2],o[3]=h[3],k){u=u||s.cx;f=f||s.cy;r=r||0;var b,w,d,g=n-u,nt=t-f,l=Math.cos(r)*i,a=Math.sin(r)*i;if(o[0]=l*h[0]-a*h[1],o[1]=a*h[0]+l*h[1],o[2]=l*h[2]-a*h[3]+(u+l*g-a*nt),o[3]=a*h[2]+l*h[3]+(f+a*g+l*nt),o[4]=o[0]*o[0]+o[1]*o[1],b=Math.sqrt(o[4]),w=Math.log(b)/Math.LN2,d=Math.atan2(o[1],o[0]),s.restrictZ[0]>w||s.restrictZ[1]<w)return!e&&s.transform(n,t,1,r,u,f,!0)}else o[2]+=n,o[3]+=t;if(c[0]=o[0]/o[4],c[1]=o[1]/-o[4],c[2]=(-o[1]*o[3]-o[0]*o[2])/o[4],c[3]=(o[1]*o[2]-o[0]*o[3])/o[4],p=s.proj([s.cx,s.cy],c),v=s.proj([s.dimc,s.dimc],o),s.restrictCntr&&!s.contains(p,s.dim,s.dim)&&(s.restrictCntr==="strict"||!s.contains(v,s.w,s.h)))return n=v[0]<s.cx?1:-1,t=v[1]<s.cy?1:-1,!e&&s.transform(n,t,i,r,0,0,!0);h[0]=o[0];h[1]=o[1];h[2]=o[2];h[3]=o[3];h[4]=o[4];y[0]=c[0];y[1]=c[1];y[2]=c[2];y[3]=c[3];s.cntrL=p;s.cntrG=v;s.cntrC=s.l2c(p);k&&(s.s=b,s.z=w,s.r=d);s.update&&(s.update=Vue.nextTick(this.apply,this))},n.prototype.apply=function(){var n=this,t=n.m,i=n.ṁ;Vue.config.async=!1;n.update=!0;n.tranMX="matrix("+t[0]+","+t[1]+","+-t[1]+","+t[0]+","+t[2]+","+t[3]+")";n.tranUX="matrix("+i[0]+","+i[1]+","+-i[1]+","+i[0]+",0,0)";n.tranUS="scale("+1/n.s+")";n.tranUR="rotate("+-n.r/Math.D2R+")";Vue.config.async=!0},n.prototype.contains=function(n,t,i,r){return r=r||0,n[0]>-r&&n[0]<t+r&&n[1]>-r&&n[1]<i+r},n.prototype.proj=function(n,t){return[this.projX(n,t),this.projY(n,t)]},n.prototype.projX=function(n,t){return t[0]*n[0]-t[1]*n[1]+t[2]},n.prototype.projY=function(n,t){return t[1]*n[0]+t[0]*n[1]+t[3]},n.prototype.l2g=function(n){return this.proj(n,this.m)},n.prototype.g2l=function(n){return this.proj(n,this.ṁ)},n.prototype.c2l=function(n){return this.crs.transform(this.crs.project(n),this.dim)},n.prototype.l2c=function(n){return this.crs.unproject(this.crs.untransform(n,this.dim))},n.prototype.c2g=function(n){return this.l2g(this.c2l(n))},n.prototype.g2c=function(n){return this.l2c(this.g2l(n))},n}();n.View=t,function(n){var t=function(){function n(){}return n.prototype.transform=function(n,t){return t=t||1,[t*(this._a*n[0]+this._b),t*(this._c*n[1]+this._d)]},n.prototype.untransform=function(n,t){return t=t||1,[(n[0]/t-this._b)/this._a,(n[1]/t-this._d)/this._c]},n.prototype.project=function(n){return[this.lng2x(n[0]),this.lat2y(n[1])]},n.prototype.unproject=function(n){return[this.x2lng(n[0]),this.y2lat(n[1])]},n.prototype.lng2x=function(n){return n},n.prototype.lat2y=function(n){return n},n.prototype.x2lng=function(n){return n},n.prototype.y2lat=function(n){return n},n}(),i,r,u;n.ACRS=t;i=function(n){function t(){n.apply(this,arguments);this.code="EPSG:4326";this._a=1/180;this._b=1;this._c=-1/180;this._d=.5;this._bounds=[-180,-90,180,90]}return __extends(t,n),t}(t);n.EPSG4326=i;r=function(n){function t(){n.apply(this,arguments);this.code="EPSG:3395";this._a=249532023e-16;this._b=.5;this._c=-249532023e-16;this._d=.5;this.__R=6378137;this.__e=function(n){return Math.sqrt(1-n*n)}(6356752.3142451793/this.__R)}return __extends(t,n),t.prototype.lng2x=function(n){return this.__R*n*Math.D2R},t.prototype.lat2y=function(n){var t=n*Math.D2R,i=this.__e*Math.sin(t);return-this.__R*Math.log(Math.max(Math.tan(Math.PI/4-t/2)/Math.pow((1-i)/(1+i),this.__e/2),1e-10))},t.prototype.x2lng=function(n){return n*Math.R2D/this.__R},t.prototype.y2lat=function(n){for(var u=Math.exp(-n/this.__R),i=Math.PI_2-2*Math.atan(u),f=0,r=.1,t;f<15&&Math.abs(r)>1e-7;f++)t=this.__e*Math.sin(i),t=Math.pow((1-t)/(1+t),this.__e/2),r=Math.PI_2-2*Math.atan(u*t)-i,i+=r;return i*Math.R2D},t}(t);n.EPSG3395=r;u=function(n){function t(){n.apply(this,arguments);this.code="EPSG:3857";this._a=249532023e-16;this._b=.5;this._c=-249532023e-16;this._d=.5;this.__R=6378137}return __extends(t,n),t.prototype.lng2x=function(n){return this.__R*n*Math.D2R},t.prototype.lat2y=function(n){var t=Math.min(Math.max(Math.sin(n*Math.D2R),1e-15-1),1-1e-15);return this.__R*Math.log((1+t)/(1-t))/2},t.prototype.x2lng=function(n){return n*Math.R2D/this.__R},t.prototype.y2lat=function(n){return(2*Math.atan(Math.exp(n/this.__R))-Math.PI_2)*Math.R2D},t}(t);n.EPSG3857=u}(i=n.CRS||(n.CRS={}))}(VAYU||(VAYU={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};__decorate=this&&this.__decorate||function(n,t,i,r){if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")return Reflect.decorate(n,t,i,r);switch(arguments.length){case 2:return n.reduceRight(function(n,t){return t&&t(n)||n},t);case 3:return n.reduceRight(function(n,r){return r&&r(t,i),void 0},void 0);case 4:return n.reduceRight(function(n,r){return r&&r(t,i,n)||n},r)}},function(n){var t=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.update=function(){},i.methods={update:i.prototype.update},i.events={"hook:created":function(){n.unveil(this,"created");var t=this;t._uid=t.$root._uid++},"hook:ready":function(){n.unveil(this,"ready");var t=this;this.$root.$watch("view.update",function(n){n&&t.update()},{deep:!0})}},__decorate([DVue()],i)}(Vue);n.RCTX=t,function(t){var i,r,u;(function(n){n[n.SVG=0]="SVG";n[n.CANVAS=1]="CANVAS";n[n.WEBGL=2]="WEBGL"})(t.TYPE||(t.TYPE={}));i=t.TYPE;r=function(n){function i(){n.apply(this,arguments)}return __extends(i,n),i.template='<svg version="1.1" class="rctx" v-attr="width:$root.view.w,height:$root.view.h"><g v-repeat="layers" v-component="{{component||\'vayu-\'+(type==\'Feature\'?geometry.type:type)}}" track-by="_uid"><\/g><\/svg>',i.replace=!0,__decorate([DVue(t)],i)}(t);t.SVG=r;n.component("vayu-rctx-"+i[i.SVG],r);u=function(n){function i(){n.apply(this,arguments)}return __extends(i,n),i.prototype.update=function(){var n=this,i,t,r;if(n.$root)for(n.$el.width=n.$root.view.w,n.$el.height=n.$root.view.h,i=n.$children,t=0,r=i.length;t<r;t++)i[t].hide||(n.$ctx.save(),i[t].render(n.$ctx,n.$root.view),n.$ctx.restore())},i.template='<canvas class="rctx"><layer v-repeat="layers" v-component="{{component||(\'vayu-\' + type)}}" track-by="_uid"><\/layer><\/canvas>',i.replace=!0,i.methods={update:i.prototype.update},i.events={"hook:ready":function(){var n=this;n.$ctx=n.$el.getContext("2d")}},__decorate([DVue(t)],i)}(t);t.CANVAS=u;n.component("vayu-rctx-"+i[i.CANVAS],u)}(t=n.RCTX||(n.RCTX={}))}(VAYU||(VAYU={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};__decorate=this&&this.__decorate||function(n,t,i,r){if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")return Reflect.decorate(n,t,i,r);switch(arguments.length){case 2:return n.reduceRight(function(n,t){return t&&t(n)||n},t);case 3:return n.reduceRight(function(n,r){return r&&r(t,i),void 0},void 0);case 4:return n.reduceRight(function(n,r){return r&&r(t,i,n)||n},r)}},function(n){var t=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.render=function(){},i.methods={render:i.prototype.render},i.events={"hook:created":function(){n.unveil(this,"created");var t=this;t._uid=t.$root._uid++},"hook:ready":function(){n.unveil(this,"ready")}},__decorate([DVue()],i)}(Vue);n.LAYR=t}(VAYU||(VAYU={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};__decorate=this&&this.__decorate||function(n,t,i,r){if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")return Reflect.decorate(n,t,i,r);switch(arguments.length){case 2:return n.reduceRight(function(n,t){return t&&t(n)||n},t);case 3:return n.reduceRight(function(n,r){return r&&r(t,i),void 0},void 0);case 4:return n.reduceRight(function(n,r){return r&&r(t,i,n)||n},r)}},function(n){var t;(function(t){var i=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.render=function(n,t){var o=t.dim,f=o*t.s*1.004,y=t.m[0]*o,p=t.m[1]*o,ot=t.m[2],st=t.m[3],s=(Math.abs(Math.cos(t.r))+Math.abs(Math.sin(t.r)))*f/2,nt=this.url,c=this._cache,h=this.$root.reqQueue,e=0,r=0,u=0,l=!0,it=Math.max(0,Math.min(18,Math.round(t.z))),a=this._tbox?this._tbox[Math.round(t.z)]:null,w,b,k,i,d;if(typeof nt=="function")do{if((l=l&&-s<(w=y*(r+.5)-p*(u+.5)+ot)&&-s<(b=p*(r+.5)+y*(u+.5)+st)&&s>w-t.w&&s>b-t.h)&&e===it&&(!a||r>=a[0]&&u<=a[1]&&r<=a[2]&&u>=a[3])){if(n.translate(w,b),n.rotate(t.r),(i=c[k=e+"."+r+"."+u])&&i.complete&&i.width&&i.height)n.drawImage(i,-f/2,-f/2,f,f),!c[k=e-1+"."+(r>>1)+"."+(u>>1)]&&h.length<h.max/2&&(d=nt(e,r,u))&&(i=new Image,i.src=d,i.preload=!0,i.onload=i.onerror=this._onTile,h.push(c[k]=i));else{i===undefined&&h.length<h.max&&(d=nt(e,r,u))&&(i=new Image,i.src=d,i.onload=i.onerror=this._onTile,h.push(c[k]=i));for(var tt=e,rt=r,ut=u,g=1,ft=0,et=0,v;tt>0;)ft+=(rt&1)*g,et+=(ut&1)*g,g*=2,i=c[--tt+"."+(rt>>=1)+"."+(ut>>=1)],i&&i.complete&&i.width&&i.height&&(v=t.dim/g)&&!(tt=0)&&n.drawImage(i,ft*v,et*v,v,v,-f/2,-f/2,f,f)}n.rotate(-t.r);n.translate(-w,-b)}l&&e<it?(e++,r<<=1,u<<=1,s/=2,o/=2,f/=2,y=t.m[0]*o,p=t.m[1]*o):r&1&&u&1?(e--,r>>=1,u>>=1,s*=2,o*=2,f*=2,y=t.m[0]*o,p=t.m[1]*o,l=!1):(r&1&&++u&&r--||r++,l=!0)}while(e)},i.prototype._onTile=function(n){if(this.$root&&n){var t=n.target||event.srcElement,i=this.$root.reqQueue.indexOf(t);i>-1&&this.$root.reqQueue.splice(i,1);t.preload||Vue.nextTick(this.$root.update)}},i.prototype._onUrl=function(n){n&&(this._cache={},typeof n=="function"?this.url=n:(typeof n=="string"||n instanceof String)&&(this.url=new Function("z","x","y","return '"+n.replace(/{([^}]+)}/g,function(n,t){var i;return t==="x"||t==="y"||t==="z"?"'+"+t+"+'":(i=t.split("|")).length>1?"'+['"+i.join("','")+"'][(x+y)%"+i.length+"]+'":t==="bbox"?"'+ (d=(20037508.3428 / Math.pow(2, z)*2)) * (x-=(z=(Math.pow(2, z)/2)))  + ',' + (y=z-y-1) * d + ',' + (x+1) * d + ',' + (y+1) * d +'":void 0})+"'")))},i.prototype._onBBox=function(n){var i,r,t;if(this._tbox=n?{}:null)for(i=[(n[0]+180)/360,(1-Math.log(Math.tan(n[1]*Math.D2R)+1/Math.cos(n[1]*Math.D2R))/Math.PI)/2,(n[2]+180)/360,(1-Math.log(Math.tan(n[3]*Math.D2R)+1/Math.cos(n[3]*Math.D2R))/Math.PI)/2],r=0,t=0;r<=18;r++,t=1<<r)this._tbox[r]=[Math.floor(i[0]*t),Math.floor(i[1]*t),Math.floor(i[2]*t),Math.floor(i[3]*t)]},i.rctx=n.RCTX.TYPE.CANVAS,i.methods={render:i.prototype.render,_onTile:i.prototype._onTile,_onUrl:i.prototype._onUrl,_onBBox:i.prototype._onBBox},i.events={"hook:created":function(){var n=this;n.url||n.$add("url");n.$watch("url",n._onUrl,{immediate:!0});n.bbox&&n.$watch("bbox",n._bbox2tbox,{immediate:!0})},"hook:beforeDestroy":function(){this.$parent.update()}},__decorate([DVue(n.LAYR)],i)}(n.LAYR);t.TILE=i;n.component("vayu-TILE",i)})(t=n.LAYR||(n.LAYR={}))}(VAYU||(VAYU={}));
//# sourceMappingURL=vayu.min.js.map
