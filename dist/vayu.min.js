"use strict";function TSC2COMP(n,t,i){var r=Object.getPrototypeOf(n.prototype).constructor,i=Object.keys(n).reduceRight(function(t,i){return r.hasOwnProperty(i)||(t[i]=n[i]),t},i||{name:n.name}),u=r.extend(i);return t&&(t[i.name]=u),u}function DVue(){return TSC2COMP}var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},Action,__decorate,VAYU;typeof CustomEvent!="function"&&function(){function n(n,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}n.prototype=Event.prototype;window.CustomEvent=n}();Action=function(){function n(t,i,r){var f=this,u;this._inertia=!0;this._ev={};this._cache={};this._queue=[];this._cb=i||function(n){t.dispatchEvent(new window.CustomEvent("action",{detail:n}))};r=r||{};for(u in n._defaults)r[u]=u in r?r[u]:n._defaults[u];this._inertia=r.inertia;(r.onmouse&&n.SPRT_MOUSE||r.onmouse===1)&&new n.Input.Mouse(t,this._callback.bind(this));(r.onwheel&&n.SPRT_MOUSE||r.onwheel===1)&&n.Input.addListeners(t,"mousewheel DOMMouseScroll",function(n){var t={s:Math.pow(1.2,Math.max(-1,Math.min(1,n.wheelDelta||-n.detail))),isMulti:!1};t.isFirst=t.isLast=t.isWheel=!0;t.x=t.y=t.r=0;t.pageX=n.pageX;t.pageY=n.pageY;t.clientX=n.clientX;t.clientY=n.clientY;f._cb(t)});(r.ontouch&&n.SPRT_TOUCH||r.ontouch===1)&&new n.Input.Touch(t,this._callback.bind(this));(r.onpoint&&n.SPRT_POINT||r.onpoint===1)&&new n.Input.Point(t,this._callback.bind(this))}return n.prototype._callback=function(t,i){var o=this,r,u,l,a,v,y,f,s,c,p,e,h;if(!o.idle&&(r=o._cache,u={x:0,y:0,r:0,s:1,pageX:null,pageY:null,clientX:null,clientY:null,isFirst:t===n.EVTYPE.START,isLast:t===n.EVTYPE.END,isMulti:i.length>1,points:i,timestamp:Date.now()},i.length&&(r.pX=i[0].pageX,r.pY=i[0].pageY,r.cX=i[0].clientX,r.cY=i[0].clientY,u.isMulti&&(l=r.pX-i[1].clientX,a=r.pY-i[1].clientY,r.pX=(r.pX+i[1].pageX)/2,r.pY=(r.pY+i[1].pageY)/2,r.cX=(r.cX+i[1].clientX)/2,r.cY=(r.cY+i[1].clientY)/2,v=Math.sqrt(Math.pow(Math.abs(l),2)+Math.pow(Math.abs(a),2)),y=-Math.atan2(l,a))),u.pageX=r.pX,u.pageY=r.pY,u.clientX=r.cX,u.clientY=r.cY,u.isFirst||u.isLast||(u.x=r.cX-r.x,u.y=r.cY-r.y,u.s=v/r.d||1,u.r=y-r.r||0),r.x=r.cX,r.y=r.cY,r.d=v,r.r=y,o.idle!==-1&&this._cb(u),this._inertia))if(f=this._queue,s=o._inertiaFn,u.isLast){if(c=performance.now(),f.length<3||s.active&&c-s.active<20||i.length&&o._inertia<0)return;for(p=Date.now(),e=f.length-1;e>1;e--)h=Math.max(p-f[e].timestamp,1),r.vx=(r.vx+f[e].x/h)/2,r.vy=(r.vy+f[e].y/h)/2,f[e].isMulti&&(r.vs=(r.vs+(f[e].s-1)/h)/2,r.vr=(r.vr+f[e].r/h)/2);r.vs=Math.max(-.001,Math.min(.001,r.vs));r.vr=Math.max(-.003,Math.min(.003,r.vr));f.length=0;s.active||(s.active=c,u.isLast=!(u.isFirst=u.isInertia=!0),u.isMulti=!!i.length,delete u.points,delete u.timestamp,o._ev=u,o._inertiaFn(0,c),u.isFirst=!1)}else u.isFirst&&(s.active=f.length=r.vx=r.vy=r.vs=r.vr=0),f.unshift(u)>6&&(f.length=6)},n.prototype._inertiaFn=function(n,t){var f=this,r=this._ev,i=this._cache,u=this._inertiaFn;u.active&&Math.abs(i.vx)>.015||Math.abs(i.vy)>.015||Math.abs(i.vr)>.0003||Math.abs(i.vs)>.0001?(r.x=n*i.vx,r.y=n*i.vy,r.r=n*i.vr,r.s=n*i.vs+1,i.vx*=.94,i.vy*=.94,i.vr*=.9,i.vs*=.9,requestAnimationFrame(function(n){return f._inertiaFn(n-t,n)})):(r.isLast=!!u.active,u.active=r.x=r.y=r.r=0,r.s=1);this._cb(r)},n.SPRT_MOUSE=!/mobile|ip(ad|hone|od)|android/i.test(navigator.userAgent),n.SPRT_TOUCH="ontouchstart"in window,n.SPRT_POINT="MSPointerEvent"in window,n._defaults={onmouse:!0,onwheel:!0,ontouch:!0,onpoint:!0,inertia:!0},n}(),function(n){var t,i;n.version="0.1.0";console.log("%c ACTION ["+n.version+"] ","color:#42b983;background-color:#333;font-weight:bold;font-size:15px;"),function(n){n[n.START=1]="START";n[n.MOVE=2]="MOVE";n[n.END=4]="END";n[n.CANCEL=8]="CANCEL"}(n.EVTYPE||(n.EVTYPE={}));t=n.EVTYPE;i=function(){function n(t,i,r){var f=this,u;this.$=[];this._cb=i;this.listener=function(n){f.handler(n)};u=t.ownerDocument.defaultView||t.ownerDocument.parentWindow;n.addListeners(t,r.evTGT,this.listener,!1);n.addListeners(u,r.evWIN,this.listener,!1)}return n.addListeners=function(n,t,i,r){t.split(" ").forEach(function(t){n.addEventListener(t,i,r)})},n.removeListeners=function(n,t,i,r){t.split(" ").forEach(function(t){n.removeEventLister(t,i,r)})},n.prototype.handler=function(){},n.prototype.setPoint=function(n,t){t?this.$.splice(n,1,{pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY}):this.$.splice(n,1)},n}();n.Input=i,function(n){var u=function(n){function i(t,r){n.call(this,t,r,i);this.offset=80}return __extends(i,n),i.prototype.handler=function(n,r){var u;if(r=r||i.evMAP[n.type],u=this.$,u.length||r===t.START)if(r&t.MOVE)if(u.length&&u.length===(n.shiftKey?2:this._which)){if(u.length===1)this.setPoint(0,n);else{var s=this.offset,f=this._ev,e=f.clientX-n.clientX+s,o=f.clientY-n.clientY-s;e||o||(e=o=1);u.splice(0,1,{pageX:f.pageX+e,pageY:f.pageY+o,clientX:f.clientX+e,clientY:f.clientY+o});u.splice(1,1,{pageX:f.pageX-e,pageY:f.pageY-o,clientX:f.clientX-e,clientY:f.clientY-o})}this._cb(r&t.START?t.START:t.MOVE,u)}else u.length&&(1===(u.length=n.shiftKey?2:this._which)?(this.setPoint(0,n),this.setPoint(1,null),this._cb(t.END,u)):(this._ev=n,this.handler(n,r+t.START)));else r===t.END?(u.length=0,this._cb(r,u)):r===t.START&&(this._which=n.which,1===(u.length=this._which<3?n.shiftKey?2:this._which:0)?this.setPoint(1,null):this._ev=n,this.handler(n,r+t.MOVE))},i.evMAP={mousedown:t.START,mousemove:t.MOVE,mouseup:t.END},i.evTGT="mousedown",i.evWIN="mousemove mouseup",i}(n),i,r;n.Mouse=u;i=function(n){function i(t,r){n.call(this,t,r,i)}return __extends(i,n),i.prototype.handler=function(n,t){n.preventDefault();t=t||i.evMAP[n.type];var r=this.$;(r.length=Math.min(n.touches.length,2))&&(this.setPoint(0,n.touches[0]),this.setPoint(1,n.touches[1]));this._cb(t,r)},i.evMAP={touchstart:t.START,touchmove:t.MOVE,touchend:t.END,touchcancel:t.CANCEL},i.evTGT="touchstart",i.evWIN="touchmove touchend touchcancel",i}(n);n.Touch=i;r=function(n){function i(t,r){n.call(this,t,r,i);this._pid=[]}return __extends(i,n),i.prototype.handler=function(n,r){if(n.pointerType!=="mouse"){n.preventDefault();r=r||i.evMAP[n.type];var e=this.$,f=this._pid,u=f.indexOf(n.pointerId);r&t.MOVE?u>-1&&(this.setPoint(u,n),this._cb(r&t.START?t.START:t.MOVE,e)):r===t.END?u>-1&&(this.setPoint(u,null),f.splice(u,1),this._cb(r,e)):r===t.START&&f.length<2&&(this.setPoint(1,f.push(n.pointerId)===1?null:n),this.handler(n,r+t.MOVE))}},i.evMAP={pointerdown:t.START,pointermove:t.MOVE,pointerup:t.END,pointercancel:t.CANCEL,pointerout:t.CANCEL,MSPointerDown:t.START,MSPointerMove:t.MOVE,MSPointerUp:t.END,MSPointerCancel:t.CANCEL},i.evTGT=window.navigator.msPointerEnabled?"MSPointerDown":"pointerdown",i.evWIN=window.navigator.msPointerEnabled?"MSPointerMove MSPointerUp MSPointerCancel":"pointermove pointerup pointercancel",i}(n);n.Point=r}(i=n.Input||(n.Input={}))}(Action||(Action={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};__decorate=this&&this.__decorate||function(n,t,i,r){if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")return Reflect.decorate(n,t,i,r);switch(arguments.length){case 2:return n.reduceRight(function(n,t){return t&&t(n)||n},t);case 3:return n.reduceRight(function(n,r){return r&&r(t,i),void 0},void 0);case 4:return n.reduceRight(function(n,r){return r&&r(t,i,n)||n},r)}};Math.R2D=180/Math.PI;Math.D2R=Math.PI/180;Math.PIx2=Math.PI*2;Math.PI_2=Math.PI/2;Function.prototype.name===undefined&&Object.defineProperty!==undefined&&Object.defineProperty(Function.prototype,"name",{get:function(){var n=/function\s([^(]{1,})\(/.exec(this.toString());return n&&n.length>1?n[1].trim():""},set:function(){}});VAYU=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.stopEvent=function(n){return n.stopPropagation(),n},t.prototype.update=function(){this.view.update=!(this.view.update=!1)},t.prototype._onResize=function(){var n=this.view,t=this.$el.getBoundingClientRect();(n.cx=(n.w=t.width)/2,n.cy=(n.h=t.height)/2,isNaN(n.cntrC[0]+n.cntrC[1]))||(n.cntrL=n.g2l([n.cx,n.cy]),this.center=n.cntrC)},t.template='<div class="vayu"v-class="action:class_action,inertia:class_inertia"><svg style="display:none"><defs><circle id="point"r="5"/><\/defs><\/svg><div v-repeat="layers|rctx"v-component="{{\'vayu-rctx-\'+_rctx}}"track-by="_uid"><\/div><content/><\/div>',t.replace=!0,t.data=function(){return{class_action:!1,class_inertia:!1,view:new t.View,layers:[]}},t.methods={stopEvent:t.prototype.stopEvent,update:t.prototype.update,_onResize:t.prototype._onResize},t.filters={rctx:function(n){var e,o,r,i,f,u;if(!n.length)return[];for(e=[],o=window.VAYU.options.components,i=0;i<n.length;i++){if(f=n[i].rctx||t.RCTX.TYPE[o["vayu-"+n[i].type].options.rctx],!f)return;u=n[i]._uid;u===undefined&&Object.defineProperty(n[i],"_uid",{value:u=++this.$root._uid});r&&r._rctx==f?(r.layers.push(n[i]),r._uid+="_"+u):e.push(r={layers:[n[i]],_rctx:f,_uid:u})}return e}},t.computed={center:{get:function(){return this.view.cntrC},set:function(n){var t=this.view;n=t.c2l(n,t.dim);t.transform(t.projX(t.cntrL,t.m)-t.projX(n,t.m),t.projY(t.cntrL,t.m)-t.projY(n,t.m))}},zoom:{get:function(){return this.view.z},set:function(n){var t=this.view;t.transform(0,0,Math.pow(2,n-t.z))}},rotation:{get:function(){return this.view.r*Math.R2D},set:function(n){var t=this.view;t.transform(0,0,1,n*Math.D2R-t.r)}}},t.created=function(){t.unveil(this,"created");var n=this;n._uid=0},t.ready=function(){var u=this,n,i;t.unveil(this,"ready");n=this;i=n.view;this.layers=this.$options.layers;(n.reqQueue=[]).max=9;Vue.util.on(window,"resize",n._onResize);n._onResize();n.$watch("layers",this.$root.update,{deep:!0});n.action=new Action(n.$el,function(t){n.view.transform(t.x,t.y,t.s,t.r,t.clientX,t.clientY);(t.isFirst||t.isLast)&&(u.class_action=t.isFirst&&!t.isWheel,u.class_inertia=t.isFirst&&t.isInertia)});var r=n.$options,f=i.c2l(r.center||[0,0]),e=Math.pow(2,r.zoom||0),o=(r.rotation||0)*Math.D2R;i.transform(i.cx-i.projX(f,i.m),i.cy-i.projY(f,i.m),e,o)},t=__decorate([DVue()],t)}(Vue),function(n){var t,i;n.version="0.3.0";console.log("%c VAYU ["+n.version+"] ","color:#42b983;background-color:#333;font-weight:bold;font-size:20px;");n.config={debug:!0,verbose:!0||{ready:!0}};n.log=function(){for(var i=[],t=0;t<arguments.length;t++)i[+t]=arguments[t];n.config.debug&&console.log.apply(console,i)};n.unveil=function(t,i,r){(n.config.verbose===!0||n.config.verbose&&n.config.verbose[i])&&console.log("["+((r||"")+t.constructor.name)+(t.id?" '"+t.id+"' ":" ")+i+"]",t)};t=function(){function n(n,t){n===void 0&&(n=new i.EPSG3857);t===void 0&&(t=256);this.m=[1,0,0,0,1];this.ṁ=new Array(4);this.m_=new Array(5);this.ṁ_=new Array(4);this.s=1;this.z=0;this.r=0;this.w=0;this.h=0;this.cx=0;this.cy=0;this.cntrL=[NaN,NaN];this.cntrG=[NaN,NaN];this.cntrC=[NaN,NaN];this.tranMX=null;this.tranUX=null;this.tranUS=null;this.tranUR=null;this.restrictZ=[0,18];this.restrictCntr=!0;this.update=!0;this.crs=n;this.dim=t;this.dimc=t/2}return n.prototype.transform=function(n,t,i,r,u,f,e){var o=this,h=o.m,y=o.ṁ,s=o.m_,c=o.ṁ_,k=i&&(i!==1||r),p,v;if(s[0]=h[0],s[1]=h[1],s[2]=h[2],s[3]=h[3],k){u=u||o.cx;f=f||o.cy;r=r||0;var b,w,d,g=n-u,nt=t-f,l=Math.cos(r)*i,a=Math.sin(r)*i;if(s[0]=l*h[0]-a*h[1],s[1]=a*h[0]+l*h[1],s[2]=l*h[2]-a*h[3]+(u+l*g-a*nt),s[3]=a*h[2]+l*h[3]+(f+a*g+l*nt),s[4]=s[0]*s[0]+s[1]*s[1],b=Math.sqrt(s[4]),w=Math.log(b)/Math.LN2,d=Math.atan2(s[1],s[0]),o.restrictZ[0]>w||o.restrictZ[1]<w)return!e&&o.transform(n,t,1,r,u,f,!0)}else s[2]+=n,s[3]+=t;if(c[0]=s[0]/s[4],c[1]=s[1]/-s[4],c[2]=(-s[1]*s[3]-s[0]*s[2])/s[4],c[3]=(s[1]*s[2]-s[0]*s[3])/s[4],p=o.proj([o.cx,o.cy],c),v=o.proj([o.dimc,o.dimc],s),o.restrictCntr&&!o.contains(p,o.dim,o.dim)&&(o.restrictCntr==="strict"||!o.contains(v,o.w,o.h)))return n=v[0]<o.cx?1:-1,t=v[1]<o.cy?1:-1,!e&&o.transform(n,t,i,r,0,0,!0);h[0]=s[0];h[1]=s[1];h[2]=s[2];h[3]=s[3];h[4]=s[4];y[0]=c[0];y[1]=c[1];y[2]=c[2];y[3]=c[3];o.cntrL=p;o.cntrG=v;o.cntrC=o.l2c(p);k&&(o.s=b,o.z=w,o.r=d,o.th=(Math.abs(Math.cos(o.r))+Math.abs(Math.sin(o.r)))*o.dim*o.s/2);o.update&&(o.update=Vue.nextTick(this.apply,this))},n.prototype.apply=function(){var n=this,t=n.m,i=n.ṁ;n.update=!0;n.tranMX="matrix("+t[0]+","+t[1]+","+-t[1]+","+t[0]+","+t[2]+","+t[3]+")";n.tranUX="matrix("+i[0]+","+i[1]+","+-i[1]+","+i[0]+",0,0)";n.tranUS="scale("+1/n.s+")";n.tranUR="rotate("+-n.r/Math.D2R+")"},n.prototype.contains=function(n,t,i,r){return r=r||0,n[0]>-r&&n[0]<t+r&&n[1]>-r&&n[1]<i+r},n.prototype.proj=function(n,t){return[this.projX(n,t),this.projY(n,t)]},n.prototype.projX=function(n,t){return t[0]*n[0]-t[1]*n[1]+t[2]},n.prototype.projY=function(n,t){return t[1]*n[0]+t[0]*n[1]+t[3]},n.prototype.l2g=function(n){return this.proj(n,this.m)},n.prototype.g2l=function(n){return this.proj(n,this.ṁ)},n.prototype.c2l=function(n){return this.crs.transform(this.crs.project(n),this.dim)},n.prototype.l2c=function(n){return this.crs.unproject(this.crs.untransform(n,this.dim))},n.prototype.c2g=function(n){return this.l2g(this.c2l(n))},n.prototype.g2c=function(n){return this.l2c(this.g2l(n))},n}();n.View=t,function(n){var t=function(){function n(){}return n.prototype.transform=function(n,t){return t=t||1,[t*(this._a*n[0]+this._b),t*(this._c*n[1]+this._d)]},n.prototype.untransform=function(n,t){return t=t||1,[(n[0]/t-this._b)/this._a,(n[1]/t-this._d)/this._c]},n.prototype.project=function(n){return[this.lng2x(n[0]),this.lat2y(n[1])]},n.prototype.unproject=function(n){return[this.x2lng(n[0]),this.y2lat(n[1])]},n.prototype.lng2x=function(n){return n},n.prototype.lat2y=function(n){return n},n.prototype.x2lng=function(n){return n},n.prototype.y2lat=function(n){return n},n}(),i,r,u;n.ACRS=t;i=function(n){function t(){n.apply(this,arguments);this.code="EPSG:4326";this._a=1/180;this._b=1;this._c=-1/180;this._d=.5;this._bounds=[-180,-90,180,90]}return __extends(t,n),t}(t);n.EPSG4326=i;r=function(n){function t(){n.apply(this,arguments);this.code="EPSG:3395";this._a=249532023e-16;this._b=.5;this._c=-249532023e-16;this._d=.5;this.__R=6378137;this.__e=function(n){return Math.sqrt(1-n*n)}(6356752.3142451793/this.__R)}return __extends(t,n),t.prototype.lng2x=function(n){return this.__R*n*Math.D2R},t.prototype.lat2y=function(n){var t=n*Math.D2R,i=this.__e*Math.sin(t);return-this.__R*Math.log(Math.max(Math.tan(Math.PI/4-t/2)/Math.pow((1-i)/(1+i),this.__e/2),1e-10))},t.prototype.x2lng=function(n){return n*Math.R2D/this.__R},t.prototype.y2lat=function(n){for(var u=Math.exp(-n/this.__R),i=Math.PI_2-2*Math.atan(u),f=0,r=.1,t;f<15&&Math.abs(r)>1e-7;f++)t=this.__e*Math.sin(i),t=Math.pow((1-t)/(1+t),this.__e/2),r=Math.PI_2-2*Math.atan(u*t)-i,i+=r;return i*Math.R2D},t}(t);n.EPSG3395=r;u=function(n){function t(){n.apply(this,arguments);this.code="EPSG:3857";this._a=249532023e-16;this._b=.5;this._c=-249532023e-16;this._d=.5;this.__R=6378137}return __extends(t,n),t.prototype.lng2x=function(n){return this.__R*n*Math.D2R},t.prototype.lat2y=function(n){var t=Math.min(Math.max(Math.sin(n*Math.D2R),1e-15-1),1-1e-15);return this.__R*Math.log((1+t)/(1-t))/2},t.prototype.x2lng=function(n){return n*Math.R2D/this.__R},t.prototype.y2lat=function(n){return(2*Math.atan(Math.exp(n/this.__R))-Math.PI_2)*Math.R2D},t}(t);n.EPSG3857=u}(i=n.CRS||(n.CRS={}))}(VAYU||(VAYU={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.update=function(){},i.methods={update:i.prototype.update},i.events={"hook:created":function(){n.unveil(this,"created");var t=this;t._uid=t.$root._uid++},"hook:ready":function(){n.unveil(this,"ready");var t=this;this.$root.$watch("view.update",function(n){n&&t.update()},{deep:!0})}},i}(Vue);n.RCTX=t;TSC2COMP(t,n),function(t){var r;(function(n){n[n.SVG=0]="SVG";n[n.CANVAS=1]="CANVAS";n[n.WEBGL=2]="WEBGL"})(t.TYPE||(t.TYPE={}));var i=t.TYPE,f={stroke:"strokeStyle","stroke-width":"lineWidth",fill:"fillStyle"},u=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.template='<svg version="1.1" class="rctx" v-attr="width:$root.view.w,height:$root.view.h"><g v-repeat="layers" v-component="{{component||\'vayu-\'+(type==\'Feature\'?geometry.type:type)}}" track-by="_uid"><\/g><\/svg>',t.replace=!0,t}(t);t.SVG=u;n.component("vayu-rctx-"+i[i.SVG],TSC2COMP(u,n));r=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.update=function(){var n=this,e,t,r,i,o,u;if(n.$root)for(n.$el.width=n.$root.view.w,n.$el.height=n.$root.view.h,e=n.$children,t=n.$ctx,r=0;r<e.length;r++)if(i=e[r],!i.hide){t.save();for(u in i.style)(o=f[u]||u)in t&&(t[o]=i.style[u]);i.render(t,n.$root.view);n.$ctx.restore()}},t.template='<canvas class="rctx"><layer v-repeat="layers" v-component="{{component||(\'vayu-\' + type)}}" track-by="_uid"><\/layer><\/canvas>',t.replace=!0,t.methods={update:t.prototype.update},t.events={"hook:ready":function(){var n=this;n.$ctx=n.$el.getContext("2d")}},t}(t);t.CANVAS=r;n.component("vayu-rctx-"+i[i.CANVAS],TSC2COMP(r,n))}(t=n.RCTX||(n.RCTX={}))}(VAYU||(VAYU={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.render=function(){},i.methods={render:i.prototype.render},i.events={"hook:created":function(){n.unveil(this,"created");var t=this;t._uid=t.$root._uid++},"hook:ready":function(){n.unveil(this,"ready")}},i}(Vue);n.LAYR=t;TSC2COMP(t,n)}(VAYU||(VAYU={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t;(function(t){var i=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.render=function(n,t){var o=t.dim,e=o*t.s,y=t.m[0]*o,p=t.m[1]*o,ot=t.m[2],st=t.m[3],s=t.th,nt=this.url,c=this._cache,h=this.$root.reqQueue,l=!0,f=Math.round(t.z+this.zoff),it=Math.max(0,Math.min(19,f)),a=this._tbox?this._tbox[f]:null,f=0,r=0,u=0,w,b,k,i,d;if(typeof nt=="function")do{if((l=l&&-s<(w=y*(r+.5)-p*(u+.5)+ot)&&-s<(b=p*(r+.5)+y*(u+.5)+st)&&s>w-t.w&&s>b-t.h)&&f===it&&(!a||r>=a[0]&&u<=a[1]&&r<=a[2]&&u>=a[3])){if(n.translate(w,b),n.rotate(t.r),(i=c[k=f+"."+r+"."+u])&&i.complete&&i.width&&i.height)n.drawImage(i,-e/2,-e/2,e,e),h.length<h.max/2&&!c[k=f-1+"."+(r>>1)+"."+(u>>1)]&&(d=nt(f-1,r>>1,u>>1))&&(i=new Image,i.src=d,i.preload=!0,i.onload=i.onerror=this._onTile,h.push(c[k]=i));else{i===undefined&&h.length<h.max&&(d=nt(f,r,u))&&(i=new Image,i.src=d,i.onload=i.onerror=this._onTile,h.push(c[k]=i));for(var tt=f,rt=r,ut=u,g=1,ft=0,et=0,v;tt>0;)ft+=(rt&1)*g,et+=(ut&1)*g,g*=2,i=c[--tt+"."+(rt>>=1)+"."+(ut>>=1)],i&&i.complete&&i.width&&i.height&&(v=t.dim/g)&&!(tt=0)&&n.drawImage(i,ft*v,et*v,v,v,-e/2,-e/2,e,e)}n.rotate(-t.r);n.translate(-w,-b)}l&&f<it?(f++,r<<=1,u<<=1,s/=2,o/=2,e/=2,y=t.m[0]*o,p=t.m[1]*o):r&1&&u&1?(f--,r>>=1,u>>=1,s*=2,o*=2,e*=2,y=t.m[0]*o,p=t.m[1]*o,l=!1):(r&1&&++u&&r--||r++,l=!0)}while(f)},i.prototype._onTile=function(n){if(this.$root&&n){var t=n.target||event.srcElement,i=this.$root.reqQueue.indexOf(t);i>-1&&this.$root.reqQueue.splice(i,1);t.preload||Vue.nextTick(this.$root.update)}},i.prototype._onUrl=function(n){n&&(this._cache={},typeof n=="function"?this.url=n:(typeof n=="string"||n instanceof String)&&(this.url=new Function("z","x","y","return '"+n.replace(/{([^}]+)}/g,function(n,t){var i;return t==="x"||t==="y"||t==="z"?"'+"+t+"+'":(i=t.split("|")).length>1?"'+['"+i.join("','")+"'][(x+y)%"+i.length+"]+'":t==="bbox"?"'+ (d=(20037508.3428 / Math.pow(2, z)*2)) * (x-=(z=(Math.pow(2, z)/2)))  + ',' + (y=z-y-1) * d + ',' + (x+1) * d + ',' + (y+1) * d +'":void 0})+"'")))},i.prototype._onBBox=function(n){var i,r,t;if(this._tbox=n?{}:null)for(i=[(n[0]+180)/360,(1-Math.log(Math.tan(n[1]*Math.D2R)+1/Math.cos(n[1]*Math.D2R))/Math.PI)/2,(n[2]+180)/360,(1-Math.log(Math.tan(n[3]*Math.D2R)+1/Math.cos(n[3]*Math.D2R))/Math.PI)/2],r=0,t=0;r<=18;r++,t=1<<r)this._tbox[r]=[Math.floor(i[0]*t),Math.floor(i[1]*t),Math.floor(i[2]*t),Math.floor(i[3]*t)]},i.rctx=n.RCTX.TYPE.CANVAS,i.methods={render:i.prototype.render,_onTile:i.prototype._onTile,_onUrl:i.prototype._onUrl,_onBBox:i.prototype._onBBox},i.events={"hook:created":function(){var n=this;n.url||n.$add("url");n.$watch("url",n._onUrl,{immediate:!0});n.bbox&&n.$watch("bbox",n._onBBox,{immediate:!0})},"hook:beforeDestroy":function(){this.$parent.update()}},i}(n.LAYR);t.TILE=i;n.component("vayu-TILE",TSC2COMP(i,t))})(t=n.LAYR||(n.LAYR={}))}(VAYU||(VAYU={}));
//# sourceMappingURL=vayu.min.js.map
